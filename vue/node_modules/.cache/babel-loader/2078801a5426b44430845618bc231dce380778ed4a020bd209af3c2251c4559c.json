{"ast":null,"code":"import _Popconfirm2 from \"element-ui/lib/theme-chalk/popconfirm.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Popconfirm from \"element-ui/lib/popconfirm\";\nimport axiosClient from \"../../../../axios\";\nimport PromoRequestBranchApproveConfirmationModal from \"./PromoRequestBranchApproveConfirmationModal.vue\";\nimport Vue from \"vue\";\nVue.use(_Popconfirm);\nexport default {\n  components: {\n    PromoRequestBranchApproveConfirmationModal\n  },\n  watch: {\n    promoRequest: {\n      handler() {\n        this.promoDetailsTransfer();\n      },\n      deep: true\n    },\n    checkedBranch: function () {\n      if (this.checkedBranch.length == 0) this.rejected = true;else this.rejected = false;\n    }\n  },\n  props: [\"promoData\", \"promoDetails\", \"promoRequest\"],\n  computed: {},\n  data() {\n    return {\n      dateStart: [],\n      dateEnd: [],\n      checkedBranch: [],\n      rejectMode: false,\n      tempPromoRequest: [],\n      rejected: true\n    };\n  },\n  mounted() {},\n  methods: {\n    approveRequest(confirm) {\n      if (confirm) for (let key in this.tempPromoRequest) axiosClient.post(\"/updateUserBranchByRequest\", {\n        id: this.tempPromoRequest[key].id,\n        dateStart: this.dateStart[key],\n        dateEnd: this.dateEnd[key]\n      }).then(response => {\n        this.$emit(\"fetchUsers\");\n      }).catch(error => {\n        console.error(error);\n      });\n    },\n    rejectBranch(reject, key) {\n      axiosClient.post(\"/deleteUserBranch\", {\n        userID: this.promoData.id,\n        company: reject.company,\n        chainCode: reject.chainCode,\n        branchName: reject.branchName,\n        req: reject.request\n      }).then(response => {\n        this.$emit(\"fetchPromoRequest\", this.promoData.id);\n      }).catch(error => {\n        console.error(error);\n      });\n      this.tempPromoRequest.splice(key, 1);\n      if (this.tempPromoRequest.length <= 0) {\n        window.location.reload();\n      }\n      this.$emit(\"fetchUsers\");\n    },\n    promoDetailsTransfer() {\n      this.tempPromoRequest = [...this.promoRequest];\n      for (let index = 0; index < this.tempPromoRequest.length; index++) {\n        this.dateStart[index] = this.tempPromoRequest[index].date_start;\n        this.dateEnd[index] = this.tempPromoRequest[index].date_end;\n      }\n      this.tempPromoRequest.forEach(temp => {});\n    }\n  }\n};","map":{"version":3,"names":["axiosClient","PromoRequestBranchApproveConfirmationModal","Vue","use","_Popconfirm","components","watch","promoRequest","handler","promoDetailsTransfer","deep","checkedBranch","length","rejected","props","computed","data","dateStart","dateEnd","rejectMode","tempPromoRequest","mounted","methods","approveRequest","confirm","key","post","id","then","response","$emit","catch","error","console","rejectBranch","reject","userID","promoData","company","chainCode","branchName","req","request","splice","window","location","reload","index","date_start","date_end","forEach","temp"],"sources":["src/components/Dashboard/Views/PullOut/PromoRequestBranchModal.vue"],"sourcesContent":["<template>\n  <div>\n    <div\n      class=\"modal fade\"\n      id=\"promoRequestBranchModal\"\n      data-bs-backdrop=\"static\"\n      data-bs-keyboard=\"false\"\n      tabindex=\"-1\"\n      aria-labelledby=\"promoRequestBranchModalLabel\"\n      aria-hidden=\"true\"\n    >\n      <div class=\"modal-dialog modal-dialog-centered modal-lg\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header py-3\">\n            <span style=\"font-size: 16px\"\n              >Promo Name:\n              <b style=\"font-size: 16px; text-transform: uppercase\">{{\n                promoData.name\n              }}</b></span\n            ><br />\n            <span\n              >Email: <b>{{ promoData.email }}</b></span\n            >\n          </div>\n          <div class=\"modal-body row pt-2 pb-3 px-4\">\n            <span class=\"text-center mb-2\" style=\"font-size: 13px\">\n              <b>{{ promoDetails.length }} Assigned Branch:</b>\n            </span>\n            <div style=\"overflow-x: auto; min-width: 350px\">\n              <table class=\"table table-borderless\">\n                <thead>\n                  <tr>\n                    <th scope=\"col\" class=\"labelRows\">Company</th>\n                    <th scope=\"col\" class=\"labelRows\">Chain Name</th>\n                    <th scope=\"col\" class=\"labelRows\">Branch Name</th>\n                    <th scope=\"col\" class=\"labelRows\">Start Date</th>\n                    <th scope=\"col\" class=\"labelRows\">Expiry Date</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr v-for=\"details in promoDetails\">\n                    <td class=\"cell text-nowrap py-1\">{{ details.company }}</td>\n                    <td class=\"cell text-nowrap py-1\">{{ details.chainCode }}</td>\n                    <td class=\"cell text-nowrap py-1\">\n                      <el-tooltip\n                        v-if=\"details.permanent\"\n                        effect=\"light\"\n                        content=\"Permanent Branch\"\n                        placement=\"top-start\"\n                      >\n                        <span class=\"p-icon\">P</span></el-tooltip\n                      >\n                      <el-tooltip\n                        v-else-if=\"!details.permanent\"\n                        effect=\"light\"\n                        content=\"Temporary Branch\"\n                        placement=\"top-start\"\n                      >\n                        <span class=\"t-icon\">T</span>\n                      </el-tooltip>\n                      &nbsp;{{ details.branchName }}\n                    </td>\n                    <td class=\"cell text-nowrap py-1\">{{ details.dateStart }}</td>\n                    <td class=\"cell text-nowrap py-1\">{{ details.dateEnd }}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n\n            <div class=\"d-flex mt-2 text-center\">\n              <span class=\"col-12 mb-2\" style=\"font-size: 13px\"\n                ><b>Promo's Request to Update the Temporary Branch</b>\n              </span>\n            </div>\n            <div style=\"overflow-x: auto; min-width: 350px\">\n              <table class=\"table table-borderless\">\n                <thead>\n                  <tr>\n                    <th scope=\"col\" class=\"labelRows\">Company</th>\n                    <th scope=\"col\" class=\"labelRows\">Chain Name</th>\n                    <th scope=\"col\" class=\"labelRows\">Branch Name</th>\n                    <th scope=\"col\" class=\"labelRows text-center\">Request</th>\n                    <th scope=\"col\" class=\"labelRows\">Reject</th>\n                    <th scope=\"col\" class=\"labelRows\">Start Date</th>\n                    <th scope=\"col\" class=\"labelRows\">Expiry Date</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr v-for=\"(request, key) in tempPromoRequest\">\n                    <td class=\"cell text-nowrap py-1\">{{ request.company }}</td>\n                    <td class=\"cell text-nowrap py-1\">{{ request.chainCode }}</td>\n                    <td class=\"cell text-nowrap py-1\">{{ request.branchName }}</td>\n                    <td class=\"cell text-nowrap py-1\">\n                      <el-tooltip\n                        v-if=\"request.request == 'remove'\"\n                        content=\"Request to remove this branch.\"\n                        placement=\"top\"\n                      >\n                        <el-tag class=\"m-0\" type=\"danger\">For Removal</el-tag>\n                      </el-tooltip>\n                      <el-tooltip\n                        v-else-if=\"request.request == 'additional'\"\n                        content=\"Request to add this branch.\"\n                        placement=\"top\"\n                      >\n                        <el-tag class=\"m-0\" color=\"white\" type=\"warning\"\n                          >New Branch</el-tag\n                        >\n                      </el-tooltip>\n                    </td>\n                    <td class=\"cell text-nowrap text-center py-1\">\n                      <el-popconfirm\n                        width=\"270\"\n                        confirm-button-text=\"Confirm\"\n                        cancel-button-text=\"Cancel\"\n                        icon-color=\"#c45656\"\n                        title=\"Are you sure you want to reject this request?\"\n                        @confirm=\"rejectBranch(request, key)\"\n                      >\n                        <button slot=\"reference\" class=\"btn btn-default py-1 px-2\">\n                          <i class=\"nc-icon nc-simple-remove\"></i>\n                        </button>\n                      </el-popconfirm>\n                    </td>\n                    <td class=\"cell text-nowrap py-1\">\n                      <fg-input class=\"text-center mb-0\" style=\"width: 150px\"\n                        ><el-date-picker\n                          v-model=\"dateStart[key]\"\n                          type=\"date\"\n                          placeholder=\"Select a Day\"\n                          :clearable=\"false\"\n                        >\n                        </el-date-picker\n                      ></fg-input>\n                    </td>\n                    <td class=\"cell text-nowrap py-1\">\n                      <fg-input class=\"text-center mb-0\" style=\"width: 150px\"\n                        ><el-date-picker\n                          v-model=\"dateEnd[key]\"\n                          type=\"date\"\n                          placeholder=\"Select a Day\"\n                          :clearable=\"false\"\n                        >\n                        </el-date-picker\n                      ></fg-input>\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n          <div class=\"modal-footer d-flex justify-content-center\">\n            <button v-show=\"!rejectMode\" class=\"btn btn-default\" data-bs-dismiss=\"modal\">\n              Cancel\n            </button>\n\n            <button\n              v-show=\"!rejectMode\"\n              class=\"btn btn-success\"\n              data-bs-toggle=\"modal\"\n              data-bs-target=\"#requestBranchApproveConfirmation\"\n              @click=\"approveRequest()\"\n            >\n              Approve this Request\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <PromoRequestBranchApproveConfirmationModal\n      :promoData=\"promoData\"\n      @confirm=\"approveRequest($event)\"\n    ></PromoRequestBranchApproveConfirmationModal>\n  </div>\n</template>\n<script>\nimport axiosClient from \"../../../../axios\";\nimport PromoRequestBranchApproveConfirmationModal from \"./PromoRequestBranchApproveConfirmationModal.vue\";\nimport { Popconfirm } from \"element-ui\";\nimport Vue from \"vue\";\n\nVue.use(Popconfirm);\n\nexport default {\n  components: {\n    PromoRequestBranchApproveConfirmationModal,\n  },\n  watch: {\n    promoRequest: {\n      handler() {\n        this.promoDetailsTransfer();\n      },\n      deep: true,\n    },\n    checkedBranch: function () {\n      if (this.checkedBranch.length == 0) this.rejected = true;\n      else this.rejected = false;\n    },\n  },\n  props: [\"promoData\", \"promoDetails\", \"promoRequest\"],\n  computed: {\n    /***\n     * Searches through table data and returns a paginated array.\n     * Note that this should not be used for table with a lot of data as it might be slow!\n     * Do the search and the pagination on the server and display the data retrieved from server instead.\n     * @returns {computed.pagedData}\n     */\n  },\n  data() {\n    return {\n      dateStart: [],\n      dateEnd: [],\n      checkedBranch: [],\n      rejectMode: false,\n      tempPromoRequest: [],\n      rejected: true,\n    };\n  },\n  mounted() {},\n  methods: {\n    approveRequest(confirm) {\n      if (confirm)\n        for (let key in this.tempPromoRequest)\n          axiosClient\n            .post(\"/updateUserBranchByRequest\", {\n              id: this.tempPromoRequest[key].id,\n              dateStart: this.dateStart[key],\n              dateEnd: this.dateEnd[key],\n            })\n            .then((response) => {\n              this.$emit(\"fetchUsers\");\n            })\n            .catch((error) => {\n              console.error(error);\n            });\n    },\n    rejectBranch(reject, key) {\n      axiosClient\n        .post(\"/deleteUserBranch\", {\n          userID: this.promoData.id,\n          company: reject.company,\n          chainCode: reject.chainCode,\n          branchName: reject.branchName,\n          req: reject.request,\n        })\n        .then((response) => {\n          this.$emit(\"fetchPromoRequest\", this.promoData.id);\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n      this.tempPromoRequest.splice(key, 1);\n      if (this.tempPromoRequest.length <= 0) {\n        window.location.reload();\n      }\n\n      this.$emit(\"fetchUsers\");\n    },\n    promoDetailsTransfer() {\n      this.tempPromoRequest = [...this.promoRequest];\n      for (let index = 0; index < this.tempPromoRequest.length; index++) {\n        this.dateStart[index] = this.tempPromoRequest[index].date_start;\n        this.dateEnd[index] = this.tempPromoRequest[index].date_end;\n      }\n      this.tempPromoRequest.forEach((temp) => {});\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.tr_num {\n  font-size: 35px;\n  font-weight: 700;\n}\n.labelRows {\n  font-size: 0.8571em;\n  color: #9a9a9a;\n}\n</style>\n"],"mappings":";;;AAgLA,OAAAA,WAAA;AACA,OAAAC,0CAAA;AAEA,OAAAC,GAAA;AAEAA,GAAA,CAAAC,GAAA,CAAAC,WAAA;AAEA;EACAC,UAAA;IACAJ;EACA;EACAK,KAAA;IACAC,YAAA;MACAC,QAAA;QACA,KAAAC,oBAAA;MACA;MACAC,IAAA;IACA;IACAC,aAAA,WAAAA,CAAA;MACA,SAAAA,aAAA,CAAAC,MAAA,YAAAC,QAAA,aACA,KAAAA,QAAA;IACA;EACA;EACAC,KAAA;EACAC,QAAA,GAOA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,OAAA;MACAP,aAAA;MACAQ,UAAA;MACAC,gBAAA;MACAP,QAAA;IACA;EACA;EACAQ,QAAA;EACAC,OAAA;IACAC,eAAAC,OAAA;MACA,IAAAA,OAAA,EACA,SAAAC,GAAA,SAAAL,gBAAA,EACApB,WAAA,CACA0B,IAAA;QACAC,EAAA,OAAAP,gBAAA,CAAAK,GAAA,EAAAE,EAAA;QACAV,SAAA,OAAAA,SAAA,CAAAQ,GAAA;QACAP,OAAA,OAAAA,OAAA,CAAAO,GAAA;MACA,GACAG,IAAA,CAAAC,QAAA;QACA,KAAAC,KAAA;MACA,GACAC,KAAA,CAAAC,KAAA;QACAC,OAAA,CAAAD,KAAA,CAAAA,KAAA;MACA;IACA;IACAE,aAAAC,MAAA,EAAAV,GAAA;MACAzB,WAAA,CACA0B,IAAA;QACAU,MAAA,OAAAC,SAAA,CAAAV,EAAA;QACAW,OAAA,EAAAH,MAAA,CAAAG,OAAA;QACAC,SAAA,EAAAJ,MAAA,CAAAI,SAAA;QACAC,UAAA,EAAAL,MAAA,CAAAK,UAAA;QACAC,GAAA,EAAAN,MAAA,CAAAO;MACA,GACAd,IAAA,CAAAC,QAAA;QACA,KAAAC,KAAA,2BAAAO,SAAA,CAAAV,EAAA;MACA,GACAI,KAAA,CAAAC,KAAA;QACAC,OAAA,CAAAD,KAAA,CAAAA,KAAA;MACA;MACA,KAAAZ,gBAAA,CAAAuB,MAAA,CAAAlB,GAAA;MACA,SAAAL,gBAAA,CAAAR,MAAA;QACAgC,MAAA,CAAAC,QAAA,CAAAC,MAAA;MACA;MAEA,KAAAhB,KAAA;IACA;IACArB,qBAAA;MACA,KAAAW,gBAAA,YAAAb,YAAA;MACA,SAAAwC,KAAA,MAAAA,KAAA,QAAA3B,gBAAA,CAAAR,MAAA,EAAAmC,KAAA;QACA,KAAA9B,SAAA,CAAA8B,KAAA,SAAA3B,gBAAA,CAAA2B,KAAA,EAAAC,UAAA;QACA,KAAA9B,OAAA,CAAA6B,KAAA,SAAA3B,gBAAA,CAAA2B,KAAA,EAAAE,QAAA;MACA;MACA,KAAA7B,gBAAA,CAAA8B,OAAA,CAAAC,IAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}