{"ast":null,"code":"import _Message2 from \"element-ui/lib/theme-chalk/message.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Message from \"element-ui/lib/message\";\nimport \"core-js/modules/es.array.slice.js\";\nimport axiosClient from \"../../../../axios\";\nexport default {\n  components: {},\n  watch: {},\n  props: [\"promoData\"],\n  computed: {},\n  data: function data() {\n    return {\n      assignBranch: [],\n      companyList: [],\n      chainCodeList: [],\n      branchNameList: [],\n      form: {\n        Company: \"\",\n        ChainCode: \"\",\n        BranchName: \"\",\n        StartDate: \"\",\n        EndDate: \"\"\n      },\n      editBranchMode: false,\n      editIndex: null,\n      disableAddBranch: true\n    };\n  },\n  mounted: function mounted() {\n    this.fetchCompany();\n  },\n  methods: {\n    fetchCompany: function fetchCompany() {\n      var _this = this;\n      axiosClient.get(\"/fetchCompany\").then(function (response) {\n        _this.companyList = response.data;\n      }).catch(function (error) {\n        console.error(error);\n      });\n    },\n    fetchChainCode: function fetchChainCode() {\n      var _this2 = this;\n      axiosClient.get(\"/fetchChain\", {\n        params: {\n          company: this.form.Company\n        }\n      }).then(function (response) {\n        _this2.chainCodeList = response.data;\n      }).catch(function (error) {\n        console.error(error);\n      });\n    },\n    fetchChainName: function fetchChainName() {\n      var _this3 = this;\n      axiosClient.get(\"/fetchChainName\", {\n        params: {\n          chainCode: this.form.ChainCode,\n          company: this.form.Company\n        }\n      }).then(function (response) {\n        _this3.branchNameList = response.data;\n      }).catch(function (error) {\n        console.error(error);\n      });\n    },\n    validateAddBranch: function validateAddBranch() {\n      if (this.form.BranchName && this.form.ChainCode && this.form.Company && this.form.StartDate && this.form.EndDate) this.disableAddBranch = false;else this.disableAddBranch = true;\n      if (this.assignBranch.length >= 3) if (!this.editBranchMode) this.disableAddBranch = true;\n    },\n    addBranchInput: function addBranchInput() {\n      console.log(\"Date: \", this.form.StartDate, this.form.EndDate);\n      var startDate = new Date(this.form.StartDate);\n      var endDate = new Date(this.form.EndDate);\n      var formattedEndDate = endDate.toISOString().slice(0, 10);\n      var formattedStartDate = startDate.toLocaleDateString(\"en-US\", {\n        year: \"numeric\",\n        month: \"2-digit\",\n        day: \"2-digit\"\n      });\n      console.log(\"formatted date:\", formattedEndDate, formattedStartDate);\n      var isStartDate = new Date(formattedStartDate);\n      var isEndDate = new Date(formattedEndDate);\n      var today = new Date();\n      today.setHours(0, 0, 0, 0);\n      if (this.permBranch == this.form.BranchName) {\n        ElMessage.error(\"It is your Permanent Branch. Kindly select other branch.\");\n      } else if (isStartDate < today) {\n        _Message.error(\"Start Date must be today or any date later than today's date.\");\n      } else if (isEndDate < isStartDate) {\n        _Message.error(\"End Date must be equal or any date later than Start date.\");\n      } else {\n        var temp = false;\n        if (this.assignBranch.length == 0) temp = true;\n        for (var i = 0; i < this.assignBranch.length; i++) {\n          if (this.editBranchMode) {\n            if (i == this.editIndex && this.form.BranchName != this.assignBranch[i].branch) {\n              this.assignBranch[i].company = this.form.Company;\n              this.assignBranch[i].chainCode = this.form.ChainCode;\n              this.assignBranch[i].branch = this.form.BranchName;\n              this.assignBranch[i].date_start = this.form.StartDate;\n              this.assignBranch[i].date_end = this.form.EndDate;\n              this.assignBranch[i].permanent = false;\n              break;\n            }\n          } else {\n            if (this.form.BranchName != this.assignBranch[i].branch) temp = true;else {\n              temp = false;\n              break;\n            }\n          }\n        }\n        if (temp) this.assignBranch.push({\n          company: this.form.Company,\n          chainCode: this.form.ChainCode,\n          branch: this.form.BranchName,\n          date_start: this.form.StartDate,\n          date_end: this.form.EndDate\n        });\n        this.form.Company = \"\";\n        this.form.ChainCode = \"\";\n        this.form.BranchName = \"\";\n        this.form.StartDate = \"\";\n        this.form.EndDate = \"\";\n        this.chainCodeList = [];\n        this.branchList = [];\n        this.editBranchMode = false;\n        this.editIndex = null;\n      }\n    }\n  }\n};","map":{"version":3,"names":["axiosClient","components","watch","props","computed","data","assignBranch","companyList","chainCodeList","branchNameList","form","Company","ChainCode","BranchName","StartDate","EndDate","editBranchMode","editIndex","disableAddBranch","mounted","fetchCompany","methods","_this","get","then","response","catch","error","console","fetchChainCode","_this2","params","company","fetchChainName","_this3","chainCode","validateAddBranch","length","addBranchInput","log","startDate","Date","endDate","formattedEndDate","toISOString","slice","formattedStartDate","toLocaleDateString","year","month","day","isStartDate","isEndDate","today","setHours","permBranch","ElMessage","_Message","temp","i","branch","date_start","date_end","permanent","push","branchList"],"sources":["src/components/Dashboard/Views/PullOut/PromoAssignBranchByAgentModal.vue"],"sourcesContent":["<template>\n  <div\n    class=\"modal fade\"\n    id=\"promoAssignBranchByAgentModal\"\n    data-bs-backdrop=\"static\"\n    data-bs-keyboard=\"false\"\n    tabindex=\"-1\"\n    aria-labelledby=\"promoAssignBranchByAgentModalLabel\"\n    aria-hidden=\"true\"\n  >\n    <div class=\"modal-dialog modal-dialog-centered modal-lg\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h6 class=\"modal-title\">\n            Assigning of Temporary Branch for promo: <b>{{ promoData.name }}</b>\n          </h6>\n        </div>\n        <div class=\"modal-body text-center\">\n          <div class=\"row\">\n            <div class=\"col-sm-6\">\n              <fg-input label=\"Company\">\n                <el-select\n                  class=\"select-default\"\n                  size=\"large\"\n                  placeholder=\"Select Company\"\n                  v-model=\"form.Company\"\n                  @change=\"fetchChainCode\"\n                >\n                  <el-option\n                    v-for=\"option in companyList\"\n                    class=\"select-default\"\n                    :value=\"option.shortName\"\n                    :label=\"option.name + ' (' + option.shortName + ') '\"\n                    :key=\"option.id\"\n                  >\n                  </el-option>\n                </el-select>\n              </fg-input>\n            </div>\n            <div class=\"col-sm-6\">\n              <fg-input label=\"Chain Code\">\n                <el-select\n                  class=\"select-default\"\n                  size=\"large\"\n                  placeholder=\"Select Chain Code\"\n                  v-model=\"form.ChainCode\"\n                  @change=\"fetchChainName\"\n                >\n                  <el-option\n                    v-for=\"option in chainCodeList\"\n                    class=\"select-default\"\n                    :value=\"option.chainCode\"\n                    :label=\"option.chainCode\"\n                    :key=\"option.chainCode\"\n                  >\n                  </el-option>\n                </el-select>\n              </fg-input>\n            </div>\n            <div class=\"col-sm-6\">\n              <fg-input label=\"Branch Name\">\n                <el-select\n                  class=\"select-default\"\n                  size=\"large\"\n                  placeholder=\"Select Branch Name\"\n                  v-model=\"form.BranchName\"\n                >\n                  <el-option\n                    v-for=\"option in branchNameList\"\n                    class=\"select-default\"\n                    :value=\"option.branchName\"\n                    :label=\"option.branchName\"\n                    :key=\"option.branchName\"\n                  >\n                  </el-option>\n                </el-select>\n              </fg-input>\n            </div>\n            <div class=\"col-sm-6 row\">\n              <div class=\"col-sm-6\">\n                <label class=\"date-label\">Start Date</label>\n                <div class=\"form-group\">\n                  <el-date-picker\n                    v-model=\"form.StartDate\"\n                    type=\"date\"\n                    placeholder=\"Pick a date\"\n                  >\n                  </el-date-picker>\n                </div>\n              </div>\n              <div class=\"col-sm-6\">\n                <label class=\"date-label\">End Date</label>\n                <div class=\"form-group\">\n                  <el-date-picker\n                    v-model=\"form.EndDate\"\n                    type=\"date\"\n                    placeholder=\"Pick a date\"\n                  >\n                  </el-date-picker>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"d-flex justify-content-center\">\n            <button class=\"btn btn-success\" @click=\"addBranchInput\">\n              Add This Branch\n            </button>\n          </div>\n          <div class=\"d-flex justify-content-center\">\n            <div style=\"overflow-x: auto; min-width: 350px\">\n              <el-table\n                class=\"table-striped p-0\"\n                :data=\"assignBranch\"\n                border\n                max-height=\"350\"\n                style=\"width: 100%\"\n              >\n                <el-table-column label=\"Branch\" width=\"400\">\n                  <template slot-scope=\"scope\">\n                    <span>{{ scope.$index + 1 }}</span>\n                  </template>\n                </el-table-column>\n                <el-table-column label=\"Start Date\" width=\"150\">\n                  <template slot-scope=\"scope\">\n                    <span>{{ scope.$index + 1 }}</span>\n                  </template>\n                </el-table-column>\n                <el-table-column label=\"End Date\" width=\"150\">\n                  <template slot-scope=\"scope\">\n                    <span>{{ scope.$index + 1 }}</span>\n                  </template>\n                </el-table-column>\n                <el-table-column label=\"Actions\" width=\"150\">\n                  <template slot-scope=\"scope\">\n                    <span>{{ scope.$index + 1 }}</span>\n                  </template>\n                </el-table-column>\n              </el-table>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer d-flex justify-content-center\">\n          <button class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n          <button class=\"btn btn-primary\" data-bs-dismiss=\"modal\">Proceed</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport axiosClient from \"../../../../axios\";\nimport { Message, MessageBox } from \"element-ui\";\n\nexport default {\n  components: {},\n  watch: {},\n  props: [\"promoData\"],\n  computed: {\n    /***\n     * Searches through table data and returns a paginated array.\n     * Note that this should not be used for table with a lot of data as it might be slow!\n     * Do the search and the pagination on the server and display the data retrieved from server instead.\n     * @returns {computed.pagedData}\n     */\n  },\n  data() {\n    return {\n      assignBranch: [],\n      companyList: [],\n      chainCodeList: [],\n      branchNameList: [],\n      form: {\n        Company: \"\",\n        ChainCode: \"\",\n        BranchName: \"\",\n        StartDate: \"\",\n        EndDate: \"\",\n      },\n      editBranchMode: false,\n      editIndex: null,\n      disableAddBranch: true,\n    };\n  },\n  mounted() {\n    this.fetchCompany();\n  },\n  methods: {\n    fetchCompany() {\n      axiosClient\n        .get(\"/fetchCompany\")\n        .then((response) => {\n          this.companyList = response.data;\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n    },\n    fetchChainCode() {\n      axiosClient\n        .get(\"/fetchChain\", {\n          params: {\n            company: this.form.Company,\n          },\n        })\n        .then((response) => {\n          //console.log(\"Chain Code Response:\", response.data);\n          this.chainCodeList = response.data;\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n    },\n    fetchChainName() {\n      axiosClient\n        .get(\"/fetchChainName\", {\n          params: {\n            chainCode: this.form.ChainCode,\n            company: this.form.Company,\n          },\n        })\n        .then((response) => {\n          // console.log(\"Chain Name Response:\", response.data);\n          this.branchNameList = response.data;\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n    },\n    validateAddBranch() {\n      if (\n        this.form.BranchName &&\n        this.form.ChainCode &&\n        this.form.Company &&\n        this.form.StartDate &&\n        this.form.EndDate\n      )\n        this.disableAddBranch = false;\n      else this.disableAddBranch = true;\n\n      if (this.assignBranch.length >= 3)\n        if (!this.editBranchMode) this.disableAddBranch = true;\n\n      // this.validateSendRequest();\n    },\n    addBranchInput() {\n      console.log(\"Date: \", this.form.StartDate, this.form.EndDate);\n      // Convert StartDate\n      const startDate = new Date(this.form.StartDate);\n      // const formattedStartDate = startDate.toISOString().slice(0, 10);\n      // Convert EndDate\n      const endDate = new Date(this.form.EndDate);\n      const formattedEndDate = endDate.toISOString().slice(0, 10);\n\n      const formattedStartDate = startDate.toLocaleDateString(\"en-US\", {\n        year: \"numeric\",\n        month: \"2-digit\",\n        day: \"2-digit\",\n      });\n      console.log(\"formatted date:\", formattedEndDate, formattedStartDate);\n\n      var isStartDate = new Date(formattedStartDate); //dd-mm-YYYY\n      var isEndDate = new Date(formattedEndDate); //dd-mm-YYYY\n      var today = new Date();\n      today.setHours(0, 0, 0, 0);\n      if (this.permBranch == this.form.BranchName) {\n        ElMessage.error(\"It is your Permanent Branch. Kindly select other branch.\");\n      }\n      // else if (\n      //   this.branchTemp.some((branch) => branch.branch === this.form.BranchName)\n      // ) {\n      //   ElMessage.error(\"You already requested this branch. Kindly choose another one.\");\n      // }\n      else if (isStartDate < today) {\n        Message.error(\"Start Date must be today or any date later than today's date.\");\n      } else if (isEndDate < isStartDate) {\n        Message.error(\"End Date must be equal or any date later than Start date.\");\n      } else {\n        let temp = false;\n        if (this.assignBranch.length == 0) temp = true;\n        for (let i = 0; i < this.assignBranch.length; i++) {\n          if (this.editBranchMode) {\n            if (\n              i == this.editIndex &&\n              this.form.BranchName != this.assignBranch[i].branch\n            ) {\n              this.assignBranch[i].company = this.form.Company;\n              this.assignBranch[i].chainCode = this.form.ChainCode;\n              this.assignBranch[i].branch = this.form.BranchName;\n              this.assignBranch[i].date_start = this.form.StartDate;\n              this.assignBranch[i].date_end = this.form.EndDate;\n              this.assignBranch[i].permanent = false;\n              break;\n            }\n          } else {\n            if (this.form.BranchName != this.assignBranch[i].branch) temp = true;\n            else {\n              temp = false;\n              break;\n            }\n          }\n        }\n        if (temp)\n          this.assignBranch.push({\n            company: this.form.Company,\n            chainCode: this.form.ChainCode,\n            branch: this.form.BranchName,\n            date_start: this.form.StartDate,\n            date_end: this.form.EndDate,\n          });\n        this.form.Company = \"\";\n        this.form.ChainCode = \"\";\n        this.form.BranchName = \"\";\n        this.form.StartDate = \"\";\n        this.form.EndDate = \"\";\n        this.chainCodeList = [];\n        this.branchList = [];\n        this.editBranchMode = false;\n        this.editIndex = null;\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.date-label {\n  font-size: 12px;\n  color: gray;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}